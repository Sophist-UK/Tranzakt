# Product structure
Tranzakt is intended to be delivered in the following forms:
* `Tranzakt Developer` - the full Tranzakt environment, capable of developing and running
Tranzakt apps.
* `Tranzakt Runtime` - a runtime environment which can execute pre-developed Tranzakt apps
but does not have any ability to develop or modify those apps.
The intention here is to enable the metadata for an app developed with Tranzakt developer
to be exported from Tranzakt Developer and then imported into Tranzakt Runtime.
* `Tranzakt Professional` - a possible future form to enhance Tranzakt Developer by allowing
the metadata to be compiled into faster, native php code which runs with a cut-down version
of Tranzakt Runtime.
(This could either be integrated into Transakt Developer, or
if revenue is needed to funding for ongoing support and development,
then instead it could be sold as a chargeable package.

# Directory structure
The directory structure below has been defined to hold Tranzakt code
and perhaps some files generated by user developed Tranzakt apps -
though most of the apps will be held dynamically in Tranzakt metadata database tables
(unless we develop a compiler to compile Tranzakt apps to Laravel php code
that can be executed directly rather than run by the Tranzakt runtime interpreter).

This design separates Laravel and other external open source code from Tranzakt code and from user developed code.
Wherever possible standard Laravel directory names are used to aid familiarity
as defined [here](https://laravel.com/docs/9.x/structure).

For security reasons, publicly accessible webspace files are held in separate directories
from php code so that they cannot be accessed through e.g. apache/nginx webservers,
and .htaccess etc. can be used to strengthen this by invalidating any attempt to execute php files
in the public webspace and / or navigate outside the public webspace using "\..\".

* **laravel** -
    contains Laravel itself - used by both core and admin - and all additional pre-written laravel packages.
    All directories containing Tranzakt-specific code are moved outside the Laravel directory
    to `core` in order to provide separation of Tranzakt code and Laravel code -
    and to separate runtime and developer code they are duplicated in the `admin` directory.
    Laravel names are kept for the purpose of familiarity.
* **core** -
    contains all code necessary to run a predefined Tranzakt website
  * **app**
  * **bootstrap**
  * **config**
  * **database**
  * **lang**
  * **resources**
  * **routes**
  * **storage** -
      contains Tranzakt files, logs etc. of interest to Tranzakt internal developers
  * **tests** -
      unit, functional and regression tests for Tranzakt.
* **admin** -
    contains code for the development environment which is **not** installed for a run-time environment.
    Will typically mimic most of the **core** Tranzakt-specific directories in order to hold all the Tranzakt
    development-only code. Bootstrap code will determine whether the URL/route is for admin and if so will
    bootstrap both the core & admin environments.
* **pages** -
    holds static page definitions when Tranzakt is used stand-alone rather than RPC from a CMS
* **public** -
    the root webspace directory for the webserver - holds all publicly accessible static files
     separate from php files which for security reasons are not directly accessible from the webserver
  * **admin** -
      if needed (TBD) holds admin-specific static files that need to be served
  * **css**
  * **js**
  * **media** -
      images, sounds, videos etc. provided by the developer
  * **uploads** -
      user uploaded files which are publicly downloadable (if you know the URL)
* **storage** -
    contains user-app files, logs etc. of interest to Tranzakt user-app developers
* **uploads** -
    optional directory to hold user uploaded files that for security reasons should not be accessible by other users.
    These files will need to be specially served by Tranzakt since they cannot be directly downloaded by the browser.
* **user** -
    The initial implementation of Tranzaky runtime is intended to be interpretive
    i.e the metadata model will be queried and the application functionality dynamically
    generated, however eventually it is hoped to provide a compiler which will compile
    the metadata into Laravel code in this directory that can then be exported
    and directly executed by php using a simplified Tranzakt runtime environment.

# Design principles
* Asynchronous initiation of API responses for later retrieval
* Parallelism and Asynchronous execution of i/o
* Loosely coupled architecture - use of server events and both server and browser listeners
to break transactions into smaller pieces
* Design by Contract to ensure interfaces are called correctly (using php-deal?)
* PHP Unit testing using phpunit
* Regression testing to ensure end-user experience using Laravel Dusk
* Defaults hierarchy to avoid having to set e.g. security on every e.g. element
* Element constraint / validation hierarchy - specify constraints and validations at table, element or form level.
* Settings for logging Tranzakt activities to JS console during development either globally
or for specific activities.
* Analytics for development / production (using Laravel Telescope)
* Runtime security
* Admin/dev security (using Laravel Sanctum?)
* Queue management (if we ever implement batch queuing) using Laravel Horizon
* Support for SQL Transactions - all or nothing changes on submitting a form.
* Support for proper foreign-key relationships in SQL.

# Laravel Research Results
Laravel Scout for search
Vite (bundled with Laravel 8) for bundling JS files to reduce number of downloads
Mews HTMLPurifier for Laravel https://github.com/mewebstudio/Purifier to avoid XSS
Laravel Sanctum (SPA / API authentication - for Admin pages which will be SPA)
Laravel UI (Vue scaffolding)
Mateus Junges' Laravel-ACL for User groups
The Control Group's Voyager - Admin feature set which includes:
    * settings management
    * BREAD (CRUD) operations
    * a media manager
    * menu builder
    * table management

# Other resources
vertabelo.com Physical Data Model for inspiration on table editor
Devdojo's Wave to pick and choose functionality for:
* Authentication - Fully loaded authentication, email verification, and password reset.
* User Profiles - Easily Customizable User Profiles.
* User Impersonation - Login as another user to resolve an issue/bug.
* Billing - Allow users to pay for your service.
* Subscription Plans - Subscription plans with different features.
* User Roles - Assign a role and permissions to a specific plan.
* Notifications - Ready-to-use Notification System.
* Announcements - Notify users about new features or updates.
* Blog - Equipped with a fully-functional blog.
* API - Ready-to-consume API for your application
* Themes - Fully configurable themes.
* Voyager integration

Note: We cannot use Wave out of the box because it is not updated frequently enough, is back level.
But we can use it as inspiration.
